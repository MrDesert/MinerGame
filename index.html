<!DOCTYPE html>
<html lang="ru">
    <head>
        <title>MinerGame</title>
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="main.css">
        <link rel="stylesheet" href="forGame.css" onerror="this.onerror=null;this.href='https://mrdesert.github.io/Tools/forGame.css'"> <!-- Локальный файл для релиза, сетевой для разработки -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta charset="utf-8">
    </head>
    <body id="ret" style="height: 100vh;">
        <div id="preloaderID"><div id="preloaderCentr"><span id="loading">Загрузка</span><span id="preloaderTextID">...</span></div></div>
        <div id="layerID">
            <img id="layerImgID" src="img/layer.png" alt=""> 
            <img id="cracksID" src="img/cracks.png" alt="">
        </div>
        <div id="hitZoneID" style="position: fixed; height: 100%; width: 100%;" onclick="hit(shovel)"></div>
        <h1>MinerGame</h1>
        <button id="langBtnID" class="btnCloseCircule" value="ru" onclick="changeLang(this.value)"></button>
        <h2><span id="currentDepth">Текущая глубина:</span> <span id="depthLevelID">0</span></h2>

        <div id="menuID" onclick="menuTreePump(false)"><img id="bookID" class="sideMenuElementIconLeftIMG" src="img/book.png" alt=""><div id="warningID" hidden></div></div>
        <div  class="rightText">
        <div><span id="wallet">Кошелёк: </span><img id="coinID" class="coinCl" src="img/coin.png" alt=""><span id="moneyID">0</span></div>
        <div><span id="clicks">Кликов: </span><span id="counterID">0</span></div>
        <div><span id="resets">Перезапусков: </span><span id="counterRebootID">0</span></div>
        <div><span id="hand_damage">Сила удара: </span><span id="hitID">1</span></div>
        <div><span id="auto_mine">Автоудар: </span><span id="autoHitInfoID">0</span></div>
        </div>
        <div id="hpTitleID" hidden>Ударов до победы: <div id="hpID" class="inline-block">4</div></div>
        <div id="hpBarBorderID">
                <div style="position: absolute;" id="prifitLayerID">
                    <span id="profit">Прибыль: </span>
                    <div id="prizeID" class="inline-block">1</div>
                    <img id="coinID" class="coinCl" src="img/coin.png" alt="">
                    <!-- <div id="luckyID"></div> -->
                </div>
            <div id="hpBarID">
            </div>
        </div>
        <div id="blurID" hidden><span id="continue">Продолжить</span></div>

        <footer>© by MrDesert - beta v0.3.3.5</footer>

<script src="forGame.js" onerror="this.onerror=null; const newScript = document.createElement('script'); newScript.src = 'https://mrdesert.github.io/Tools/forGame.js'; document.head.appendChild(newScript);"></script><!-- Локальный файл для релиза, сетевой для разработки -->
<script src="console.js" onload="createConsole(true, 'F2')"></script><!--Установить false перед релизом-->
<script>
    const useYSDK = false; //Установить true перед релизом
    let resurses = false;
    let sdkLoad = false;

    const script = document.createElement('script');
    script.src = "https://yandex.ru/games/sdk/v2";
    script.async = true;

    document.getElementsByTagName('footer')[0].innerHTML = "© MrDesert - v0.3.3.5"; //Заменяю версию для яндекса
    document.head.appendChild(script);
    
    script.onload = function(){
        myLog?.("script.onload");
        YaGames.init()
            .then(ysdk => {
                const langSDK = ysdk.environment?.i18n?.lang; //Запрашиваем язык у YSDK
                myLog?.("язык - " + ysdk.environment?.i18n?.lang);
                changeLang(langSDK);
                document.documentElement.lang = langSDK;
                window.ysdk = ysdk;
                if(window.ysdk){
                    sdkLoad = true;
                    myLog?.("SDK загружен - " + sdkLoad);
                }
            })
            .then(()=>{
                return new Promise((resolve)=>{
                    const chekcInterval = setInterval(()=>{
                        if (sdkLoad && resurses){
                            myLog?.("Загруженны ресурсы и SDK");
                            ysdk.features?.GameplayAPI?.start?.();
                            clearInterval(chekcInterval);
                            resolve();
                        }
                        else if(sdkLoad){myLog?.("Ожидание ресурсов - " + resurses)}
                        else if (resurses){myLog?.("Ожидание SDK - " + sdkLoad)}
                        else{myLog?.("Ожидание ресурсов и CDK");}
                    }, 400);
                })
            })
            .then(()=>{                 
                ysdk.features.LoadingAPI.ready();
            })
            .then(()=>{
                setTimeout(function(){
                    loadedGame();}, 500);
            })
            .catch(console.error);
    };
    window.addEventListener('load', function(){
        resurses = true;
        myLog?.("Ресурсы загруженны - " + resurses);
    }) 


if(!useYSDK){
     setTimeout(function(){ sdkLoad =true; resurses=true; loadedGame();}, 500);
}

</script>
        <script src="math.js"></script>
        <script src="main.js" onerror="this.onerror=null; const newScript = document.createElement('script'); newScript.src = 'https://mrdesert.github.io/Tools/main.js'; document.head.appendChild(newScript);"></script><!-- Локальный файл для релиза, сетевой для разработки -->
        <script src="DOM.js" onerror="this.onerror=null; const newScript = document.createElement('script'); newScript.src = 'https://mrdesert.github.io/Tools/DOM.js'; document.head.appendChild(newScript);"></script><!-- Локальный файл для релиза, сетевой для разработки -->
        <script src="script.js"></script>
    </body>
</html>