<!DOCTYPE html>
<html lang="ru">
    <head>
        <title>MinerGame</title>
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="main.css">
        <link rel="stylesheet" href="forGame.css" onerror="this.onerror=null;this.href='https://mrdesert.github.io/Tools/forGame.css'"> <!-- Локальный файл для релиза, сетевой для разработки -->
        <script src="math.js" onerror="this.onerror=null; const newScript = document.createElement('script'); newScript.src = 'https://mrdesert.github.io/Tools/math.js'; document.head.appendChild(newScript);"></script><!-- Локальный файл для релиза, сетевой для разработки -->
        <script src="DOM.js" onerror="this.onerror=null; const newScript = document.createElement('script'); newScript.src = 'https://mrdesert.github.io/Tools/DOM.js'; document.head.appendChild(newScript);"></script><!-- Локальный файл для релиза, сетевой для разработки -->
        <script src="main.js" onerror="this.onerror=null; const newScript = document.createElement('script'); newScript.src = 'https://mrdesert.github.io/Tools/main.js'; document.head.appendChild(newScript);"></script><!-- Локальный файл для релиза, сетевой для разработки -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta charset="utf-8">
    </head>
    <body id="ret" style="height: 100vh;">
        <script src="forGame.js" onerror="this.onerror=null; const newScript = document.createElement('script'); newScript.src = 'https://mrdesert.github.io/Tools/forGame.js'; document.body.appendChild(newScript);"></script><!-- Локальный файл для релиза, сетевой для разработки -->
        <!--Установить false перед релизом-->
        <script src="console.js" 
            onload="createConsole(false, 'F2')" 
            onerror="
                this.onerror=null; 
                const newScript = document.createElement('script'); 
                newScript.src = 'https://mrdesert.github.io/Tools/console.js'; 
                newScript.onload = function(){createConsole(true, 'F2')};
                newScript.onerror=function(){console.log('НетСетевогоФайла')}
                document.body.appendChild(newScript);">
        </script>
        <!-- Локальный файл для релиза, сетевой для разработки -->

        <div id="preloaderID"><div id="preloaderCentr"><span id="loading"></span><span id="preloaderTextID">...</span></div></div>
        <div id="layerID">
            <div id="layerAllID">
                <img id="layerImgID" src="img/layer.png" alt="">
                <img id="layerGoldID" src="img/layer_gold.png" alt="" hidden>
            </div>
            <img id="cracksID" src="img/cracks.png" alt="">
        </div>
        <div id="hitZoneID" style="position: fixed; height: 100%; width: 100%;" onclick="hit(shovel)"></div>
        <h1>MinerGame</h1>

        <button id="langBtnID" class="btnCloseCircule" value="ru" onclick="changeLang(this.value)"></button>
        <h2><span id="currentDepth">Текущая глубина:</span> <span id="depthLevelID">0</span></h2>

        <div id="leftTopMenu"><div id="menuID" onclick="menuTreePump(false)"><img id="bookID" class="sideMenuElementIconLeftIMG" src="img/book.png" alt=""><div id="warningID" hidden></div></div></div>
        <div id="stat" class="rightText">
            <div hidden><span id="clicks">Кликов: </span><span id="counterID">0</span></div>
            <div hidden><span id="resets">Перезапусков: </span><span id="counterRebootID">0</span></div>
            <span id="wallet" hidden>Кошелёк: </span><img id="coinID" class="coinCl" src="img/coin.png" alt=""><span id="moneyID">0</span>
            <span id="hand_damage" hidden>Сила удара: </span><img id="coinID" class="coinCl" src="img/pickaxe_transparent_390x390.png" style="margin-left: 6px;" alt=""><span id="hitID">1</span>
            <span id="auto_mine" hidden>Автоудар: </span><img id="coinID" class="coinCl" src="img/helmet-pickaxe_transparent_450x450.png" style="margin-left: 6px;" alt=""><span id="autoHitInfoID">0</span>
        </div>
        <div id="hpTitleID" hidden>Ударов до победы: <div id="hpID" class="inline-block">4</div></div>
        <div id="hpBarBorderID">
                <div style="position: absolute;" id="prifitLayerID">
                    <span id="luckyID">X2</span>
                    <span id="profit">Прибыль: </span>
                    <span id="prizeID">1</span>
                    <span id="prizeID2"></span>
                    <img id="coinID2" class="coinCl" src="img/coin.png" alt="">
                </div>
            <div id="hpBarID">
            </div>
        </div>
        <div id="blurID" hidden><span id="continue">Продолжить</span></div>
        <footer style="z-index: 4;">© by MrDesert - beta v0.4.0.0</footer>
<script>
    const useYSDK = true; //Установить true перед релизом
    let resurses = false;
    let sdkLoad = false;

    const script = document.createElement('script');
    script.src = "https://yandex.ru/games/sdk/v2";
    script.async = true;

    document.getElementsByTagName('footer')[0].innerHTML = "© MrDesert - v0.4.0.0"; //Заменяю версию для яндекса
    document.head.appendChild(script);
    
    script.onload = function(){
        myLog?.("script.onload");
        YaGames.init()
            .then(ysdk => {
                const langSDK = ysdk.environment?.i18n?.lang; //Запрашиваем язык у YSDK
                if(langSDK == "ru"){document.getElementById("loading").textContent = "Загрузка"}
                else{document.getElementById("loading").textContent = "Loading"};
                myLog?.("язык - " + ysdk.environment?.i18n?.lang);
                changeLang(langSDK);
                document.documentElement.lang = langSDK;
                window.ysdk = ysdk;
                if(window.ysdk){
                    sdkLoad = true;
                    myLog?.("SDK загружен - " + sdkLoad);
                }
            })
            .then(()=>{
                return new Promise((resolve)=>{
                    const chekcInterval = setInterval(()=>{
                        if (sdkLoad && resurses){
                            myLog?.("Загруженны ресурсы и SDK");
                            ysdk.features?.GameplayAPI?.start?.();
                            clearInterval(chekcInterval);
                            resolve();
                        }
                        else if(sdkLoad){myLog?.("Ожидание ресурсов - " + resurses)}
                        else if (resurses){myLog?.("Ожидание SDK - " + sdkLoad)}
                        else{myLog?.("Ожидание ресурсов и CDK");}
                    }, 400);
                })
            })
            .then(()=>{                 
                ysdk.features.LoadingAPI.ready();
            })
            .then(()=>{
                setTimeout(function(){
                    loadedGame();
                }, 30);
            })
            .catch(console.error);
    };
    window.addEventListener('load', function(){
        resurses = true;
        myLog?.("Ресурсы загруженны - " + resurses);
    }) 


if(!useYSDK){
     setTimeout(function(){ sdkLoad =true; resurses=true; loadedGame();}, 1000);
}

</script>
        <script src="script.js"></script>
    </body>
</html>